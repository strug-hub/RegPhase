% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RoP_function.R
\name{RoP}
\alias{RoP}
\title{Regression on Phase (RoP) test}
\usage{
RoP(Y, Hap1, Hap2, family = c("gaussian", "binomial"))
}
\arguments{
\item{Y}{Numeric vector of length n containing the outcome.
For \code{family = "gaussian"} values are treated as continuous;
for \code{family = "binomial"} they must be coded as \code{0/1}.}

\item{Hap1}{Numeric matrix of dimension n by 2 giving the haplotype on
one homologous chromosome at the two variants.  Entries are
integers indexing the observed alleles; within each column the
smallest integer is taken as the reference allele.}

\item{Hap2}{Numeric matrix of dimension n by 2 giving the haplotype on
the other homologous chromosome, structured identically to
\code{Hap1}.}

\item{family}{Character string specifying the GLM family to use.
Accepts \code{"gaussian"} for continuous outcomes
or \code{"binomial"} for binary outcomes.}
}
\value{
A named vector with elements \code{p_cis} and \code{p_trans}
        containing the p-values for the cis- and trans-phase effects.
}
\description{
Performs the Regression-on-Phase test to determine whether the \emph{cis}
or \emph{trans} configuration of two genetic variants influences the
outcome. Supports both biallelic and multiallelic loci and handles
continuous (Gaussian) or binary (binomial) responses.
}
\examples{
##Example1: Continous Y, biallelic variants, Cis effect
N=1000
Hap1<-matrix(rbinom(N*2,size = 1,prob=0.2),ncol=2)
Hap2<-matrix(rbinom(N*2,size = 1,prob=0.2),ncol=2)
Cis<-Hap1[,1]*Hap1[,2]+Hap2[,1]*Hap2[,2]
Y<-Cis+rnorm(n=N)
RoP(Y,Hap1,Hap2,family="gaussian")

##Example2: Binary Y,biallelic variants, Trans effect
N=1000
Hap1<-matrix(rbinom(N*2,size = 1,prob=0.2),ncol=2)
Hap2<-matrix(rbinom(N*2,size = 1,prob=0.2),ncol=2)
Trans<-Hap1[,1]*Hap2[,2]+Hap2[,1]*Hap1[,2]
p<-exp(2*Trans)/(1+exp(2*Trans))
Y<-rbinom(n=1000,size = 1,prob=p)
RoP(Y,Hap1,Hap2,family="binomial")

##Example3: Continous Y, multi-allelic variants, Cis effect
N=1000
Hap1<-cbind(matrix(sample(c(0,1,2),N,prob=c(0.3,0.4,0.3),replace=TRUE),ncol=1),
            matrix(sample(c(0,1,2,3),N,prob=c(0.25,0.25,0.25,0.25),replace=TRUE),ncol=1))
Hap2<-cbind(matrix(sample(c(0,1,2),N,prob=c(0.3,0.4,0.3),replace=TRUE),ncol=1),
            matrix(sample(c(0,1,2,3),N,prob=c(0.25,0.25,0.25,0.25),replace=TRUE),ncol=1))

Cis<-as.numeric((Hap1[,1]==1)&(Hap1[,2]==3))+as.numeric((Hap2[,1]==1)&(Hap2[,2]==3))
Y<-Cis+rnorm(n=N)
RoP(Y,Hap1,Hap2,family="gaussian")
}
